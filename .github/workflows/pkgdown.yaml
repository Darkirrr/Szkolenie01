# .github/workflows/quarto-publish.yml
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Buduje i publikuje stronÄ™Â Quarto (HTML) na gaÅ‚Ä…ÅºÂ ghâ€‘pages.
# DziaÅ‚a dla projektÃ³w RÂ Markdown, Python oraz czystoÂ .qmd.

name: quarto-publish

on:
  push:
    branches: [ main, master ]      # render przy kaÅ¼dymÂ push do gÅ‚Ã³wnej gaÅ‚Ä™zi
  workflow_dispatch:                # pozwala uruchomiÄ‡ rÄ™cznie zÂ UI

permissions:
  contents: write                   # potrzebne, by wypchnÄ…Ä‡ doÂ ghâ€‘pages

jobs:
  build-site:
    runs-on: ubuntu-latest

    steps:
      # 1) Sklonuj repo
      - uses: actions/checkout@v4

      # 2) Zainstaluj Quarto CLI (automatycznie dobiera najnowszÄ… wersjÄ™)
      - uses: quarto-dev/quarto-actions/setup@v2
        with:
          install-dependencies: true    # pobiera pandoc + typowe rozszerzenia

      # 3) (opcjonalnie) zainstaluj R i pakiety, jeÅ›li masz chunki R
      - uses: r-lib/actions/setup-r@v2
        with:
          use-public-rspm: true         # szybsze binarki Posit Public

      - name: Install R packages needed by docs
        run: |
          install.packages(c("tidyverse", "knitr", "gt"))
        shell: Rscript {0}

      # 4) Render caÅ‚ej strony do domyÅ›lnego folderu _site/
      - name: Render Quarto project
        run: quarto render

      # 5) Deploy do gaÅ‚Ä™zi ghâ€‘pages (GitHub Pages)
      - name: Publish to gh-pages ðŸš€
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: _site                # katalog wygenerowany przez Quarto
          publish_branch: gh-pages          # docelowa gaÅ‚Ä…Åº
          keep_files: true                  # nie kasuj rÄ™cznie wgranych plikÃ³w
